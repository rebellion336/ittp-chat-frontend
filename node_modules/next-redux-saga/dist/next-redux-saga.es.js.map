{"version":3,"file":"next-redux-saga.es.js","sources":["../index.js"],"sourcesContent":["import React, {Component} from 'react'\nimport {END} from 'redux-saga'\n\nfunction hoc(config) {\n  return BaseComponent => {\n    class WrappedComponent extends Component {\n      static async getInitialProps(ctx) {\n        const {isServer, store} = ctx\n\n        let props\n        if (BaseComponent.getInitialProps) {\n          props = await BaseComponent.getInitialProps(ctx)\n        }\n\n        // Keep saga running on the client (async mode)\n        if (config.async && !isServer) {\n          return props\n        }\n\n        // Force saga to end in all other cases\n        store.dispatch(END)\n        await store.sagaTask.done\n\n        // Restart saga on the client (sync mode)\n        if (!isServer) {\n          store.runSagaTask()\n        }\n\n        return props\n      }\n\n      render() {\n        return <BaseComponent {...this.props} />\n      }\n    }\n\n    return WrappedComponent\n  }\n}\n\nfunction withReduxSaga(arg) {\n  const defaultConfig = {async: false}\n\n  if (typeof arg === 'function') {\n    return hoc(defaultConfig)(arg)\n  }\n\n  return hoc({...defaultConfig, ...arg})\n}\n\nexport default withReduxSaga\n"],"names":["hoc","config","WrappedComponent","props","ctx","isServer","store","BaseComponent","getInitialProps","async","dispatch","END","sagaTask","done","runSagaTask","Component","withReduxSaga","arg","defaultConfig"],"mappings":";;;;;;;;;;;;;;;;AAAA,AAGA,SAASA,GAAT,CAAaC,MAAb,EAAqB;SACZ,yBAAiB;QAChBC,gBADgB;;;;;;;;;;;iCA2BX;iBACA,oBAAC,aAAD,EAAmB,KAAKC,KAAxB,CAAP;;;;;iFA1B2BC,GAFT;;;;;;4BAAA,GAGQA,GAHR,CAGXC,QAHW,EAGDC,KAHC,GAGQF,GAHR,CAGDE,KAHC;yBAAA;;yBAMdC,cAAcC,eANA;;;;;;2BAOFD,cAAcC,eAAd,CAA8BJ,GAA9B,CAPE;;;yBAAA;;;0BAWdH,OAAOQ,KAAP,IAAgB,CAACJ,QAXH;;;;;qDAYTF,KAZS;;;;;0BAgBZO,QAAN,CAAeC,GAAf;;2BACML,MAAMM,QAAN,CAAeC,IAjBH;;;;;wBAoBd,CAACR,QAAL,EAAe;4BACPS,WAAN;;;qDAGKX,KAxBW;;;;;;;;;;;;;;;;;;;MACSY,SADT;;WAgCfb,gBAAP;GAhCF;;;AAoCF,SAASc,aAAT,CAAuBC,GAAvB,EAA4B;MACpBC,gBAAgB,EAACT,OAAO,KAAR,EAAtB;;MAEI,OAAOQ,GAAP,KAAe,UAAnB,EAA+B;WACtBjB,IAAIkB,aAAJ,EAAmBD,GAAnB,CAAP;;;SAGKjB,iBAAQkB,aAAR,EAA0BD,GAA1B,EAAP;;;;;"}